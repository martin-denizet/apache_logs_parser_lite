# apache_logs_parser_lite

__This is an example tool developed as a project during Python classes. It was not meant to be used in the _"real world"_.__
There is 2 scripts:
* _generate_json.py_ : To convert standard Apache combined logs files into JSON files
* _display_stats.py_: To display stats generated from a JSON file


## Requirements

* Linux
* git (for installation)
* Python >= 3.7

## Install from git

```shell
git https://github.com/martin-denizet/apache_logs_parser_lite ~/apache_logs_parser_lite
```

## generate_json.py
This tool converts standard combined Apache web server logs into Python objects and saves them in a JSON file.

### Apache log format
Expected log format is:
```apacheconf
# Common Log Format
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-agent}i\"" combined
```
Sample line:
```shell
93.114.45.13 - - [17/May/2015:10:05:14 +0000] "GET /favicon.ico HTTP/1.1" 200 3638 "-" "Mozilla/5.0 (X11; Linux x86_64; rv:25.0) Gecko/20100101 Firefox/25.0"
```

### JSON format
Single entry example:
```json
[
    {
        "remote_ip": "83.149.9.216",
        "log_name": "-",
        "user": "-",
        "time": "17/May/2015:10:05:03 +0000",
        "request": "GET /presentations/logstash-monitorama-2013/images/kibana-search.png HTTP/1.1",
        "response": "200",
        "bytes": "203023",
        "referrer": "http://semicomplete.com/presentations/logstash-monitorama-2013/",
        "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1700.77 Safari/537.36",
        "method": "GET",
        "url": "/presentations/logstash-monitorama-2013/images/kibana-search.png",
        "protocol": "HTTP/1.1",
        "system_agent": "Mac OS X 10_9_1"
    }
]
```

### Usage

```shell
~/apache_logs_parser_lite/generate_json.py -h
```

### Examples

```shell
~/apache_logs_parser_lite/generate_json.py access.log --output-json access.json
```

## display_stats.py

Display statistics from a file generated by _generate_json.py_

### Stats available

* Hits per page - Top 10
* Megabytes per IP - Top 10
* Response codes chart
* Hits per OS - Top 10
* Hits per time range
* Total hits
* Total traffic size in GB
* Number of different visitors
* Number of different URLs visited

### Usage

```shell
~/apache_logs_parser_lite/display_stats.py -h
```

### Examples

```shell
~/apache_logs_parser_lite/display_stats.py access.json
```

## Issue tracker

https://github.com/martin-denizet/apache_logs_parser_lite/issues

## Known issues

* Too big of an input file could result in an out of memory error. It's not recommended running the tool on a production
  server for input files exceeding 1GB in size.
* Parser could break in case of Apache configuration change. If IP resolution of the IPs would be enabled for example.

## Todo

* Display start datetime and end datetime for the data

## Development

### How to contribute

* Please make a PR for the __develop__ branch.
* Make sure tests are up-to-date and passing.

### Code style

Code style compliant with flake8.

Test code style with flake8:
```shell
pip3 install flake8
# In the directory where the scripts are located
flake8 ./
```

## License

GPL-3.0 License
